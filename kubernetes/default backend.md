# default backend

## 业务背景

自从上次混合云的大集群发生故障，而导致服务大批量的不可用，持续时间很长。吃了这次苦头之后，需要避免下次再次发生，采取的措施主要是将一个大集群切割成两个小集群而实现互备。有以下优势：

1. 当其中一个集群发生故障时，影响范围缩小
2. 集群升级某些重要组件时，而导致服务不可用，可以集群间相互切换而达到不停机更新
3. 单机房服务器数量有限，无法在单机房扩容节点
4. 异地机房网络节点间网络联通问题，不如各自建集群

## 架构

下图是调用链路的架构图

1. 未上新集群时，直接由textin 调旧集群服务。
2. 上了新集群之后，由textin分原来部分流量到新集群，由于新集群并没有上线所有服务，所以没有的服务需要代理到旧集群，也就是下图中新集群ingress-nginx 到旧集群ingress-nginx的虚线。集群中已经存在的服务，则直接调取业务pod返回。

![image-20220615002022589](../asserts/image-20220615002022589.png)

注解：

- textin：



